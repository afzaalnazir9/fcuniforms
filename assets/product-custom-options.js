jQuery((function(t){"use strict";console.log("custom js...");let e=0,a=0,n=0,d=0,i=0,o=0,s=0,c=0,l=!1,h=!1;var r=0;function p(){(r=t(".t4s-product-price").html()).includes("t4s-price-from")?r=r.split("</span>")[1]:r.includes("</span></ins></span>")&&(r=r.split("</span></ins></span>")[0].split('<ins><span class="money">')[1].split("</span>")[0]),r.includes("USD")&&(r=r.split(" USD")[0]),r=Number(r.replace("$","").trim()),console.log("Base product cost",r)}function u(){(0===r||function(){let e=t(".t4s-product-price").html();return e.includes("t4s-price-from")?e=e.split("</span>")[1]:e.includes("</span></ins></span>")&&(e=e.split("</span></ins></span>")[0].split('<ins><span class="money">')[1].split("</span>")[0]),e.includes("USD")&&(e=e.split(" USD")[0]),e=Number(e.replace("$","").trim()),e}()<r)&&p(),setTimeout((()=>{const l=e+a+n+d+i+o+s+c+r;t(".t4s-product-price").html("$"+l.toFixed(2)+" USD")}),1e3)}function f(){e=0,a=0,n=0,i=0,o=0,s=0,c=0,t("#add-patches-on-chest").val(t("#target option:first").val()),t(document).find(".left-chest-patch").addClass("hidden"),t(document).find(".right-chest-patch").addClass("hidden"),t(".left-chest-patch").find(".u4a-patch-value").text(""),t(".right-chest-patch").find(".u4a-patch-value").text(""),t(document).find(".left-chest-patch").find("input:radio").prop("checked",!1),t(document).find(".right-chest-patch").find("input:radio").prop("checked",!1),t("#add-patches-on-shoulders").val(t("#target option:first").val()),t(document).find(".left-shoulder-patch").addClass("hidden"),t(document).find(".right-shoulder-patch").addClass("hidden"),t(".left-shoulder-patch").find(".u4a-patch-value").text(""),t(".right-shoulder-patch").find(".u4a-patch-value").text(""),t(document).find(".left-shoulder-patch").find("input:radio").prop("checked",!1),t(document).find(".right-shoulder-patch").find("input:radio").prop("checked",!1)}t("#engrave-stock-badge").on("keyup",(function(e){const a=t("#engrave-stock-badge").val();console.log(a),a.length>0?(l=!0,c=7.99,u()):(l=!1,c=0,u())})),t(document).on("change","#add-patches-to-shirt",(function(e){f(),"Yes"==t(this).val()?(t(document).find(".patchesLevel1").removeClass("hidden"),t(document).find(".patchesLevel1").removeClass("hidden"),t(document).find("#tailoring-requires-additional-days").prop("checked",!0)):(t(document).find(".patchesLevel1").addClass("hidden"),t(document).find("#tailoring-requires-additional-days").prop("checked",!1))})),t(document).on("change","#add-striping",(function(e){f(),"Yes"==t(this).val()?(c+=6.99,u(),t(".patchesLevel1.expedited-shipping").hide(),t(document).find(".patchesLevel2").removeClass("hidden"),t(document).find(".patchesLevel2").removeClass("hidden"),t(document).find("#striping-requires-additional-days").prop("checked",!0)):(c-=6.99,u(),t(document).find(".patchesLevel2").addClass("hidden"),t(".patchesLevel1.expedited-shipping").show(),t(document).find("#striping-requires-additional-days").prop("checked",!1))})),t(document).on("change","#add-patches-on-chest",(function(d){const i=t(this).find(":selected").data("target");e=t(this).find(":selected").data("amount"),t(document).find(".left-chest-patch").find("input:radio").prop("checked",!1),t(document).find(".right-chest-patch").find("input:radio").prop("checked",!1),t(".left-chest-patch").find(".u4a-patch-value").text(""),a=0,t(".right-chest-patch").find(".u4a-patch-value").text(""),n=0,"left-chest-patch"==i?(t(document).find(".left-chest-patch").removeClass("hidden"),t(document).find(".right-chest-patch").addClass("hidden")):"right-chest-patch"==i?(t(document).find(".right-chest-patch").removeClass("hidden"),t(document).find(".left-chest-patch").addClass("hidden")):"left-right-chest-patch"==i?(t(document).find(".right-chest-patch").removeClass("hidden"),t(document).find(".left-chest-patch").removeClass("hidden")):(t(document).find(".right-chest-patch").addClass("hidden"),t(document).find(".left-chest-patch").addClass("hidden"))})),t(document).on("change","#add-patches-on-shoulders",(function(e){const a=t(this).find(":selected").data("target");i=t(this).find(":selected").data("amount"),t(document).find(".left-shoulder-patch").find("input:radio").prop("checked",!1),t(document).find(".right-shoulder-patch").find("input:radio").prop("checked",!1),t(".left-shoulder-patch").find(".u4a-patch-value").text(""),t(".right-shoulder-patch").find(".u4a-patch-value").text(""),o=0,s=0,"left-shoulder-patch"==a?(t(document).find(".left-shoulder-patch").removeClass("hidden"),t(document).find(".right-shoulder-patch").addClass("hidden")):"right-shoulder-patch"==a?(t(document).find(".right-shoulder-patch").removeClass("hidden"),t(document).find(".left-shoulder-patch").addClass("hidden")):"left-right-shoulder-patch"==a?(t(document).find(".right-shoulder-patch").removeClass("hidden"),t(document).find(".left-shoulder-patch").removeClass("hidden")):(t(document).find(".right-shoulder-patch").addClass("hidden"),t(document).find(".left-shoulder-patch").addClass("hidden"))})),t(document).on("change","#add-patches-on-back",(function(a){const n=t(this).find(":selected").data("target");e=t(this).find(":selected").data("amount"),t(document).find(".back-patch").find("input:radio").prop("checked",!1),t(".back-patch").find(".u4a-patch-value").text(""),d=0,"back-patch"==n&&t(document).find(".back-patch").removeClass("hidden")})),t("#quantity").on("change",(function(){console.log("New quantity",t("#quantity").val()),setTimeout((()=>u()),1500)})),t(document).on("click",".t4s-quantity-selector",(function(){const e=t("#quantity").val();e&&(console.log("New product qty",e),setTimeout((()=>u()),1500))})),t(document).on("change","#select-hemming-length",(function(e){t(this).find(":selected").data("target");c=t(this).find(":selected").data("amount"),0!=c?(h=!0,u()):(h=!1,u())})),t(document).on("change",".back-patch input[type=radio]",(function(e){d=t(this).data("amount");const a=parseFloat(t(this).data("amount"))?" + $"+parseFloat(t(this).data("amount")):"";console.log(a),t(".back-patch").find(".u4a-patch-value").text("- "+t(this).val()),u()})),t(document).on("change",".left-chest-patch input[type=radio]",(function(e){a=t(this).data("amount");const n=parseFloat(t(this).data("amount"))?" + $"+parseFloat(t(this).data("amount")):"";console.log(n),t(".left-chest-patch").find(".u4a-patch-value").text("- "+t(this).val()),u()})),t(document).on("change",".right-chest-patch input[type=radio]",(function(e){n=t(this).data("amount");const a=parseFloat(t(this).data("amount"))?" + $"+parseFloat(t(this).data("amount")):"";console.log(a),t(".right-chest-patch").find(".u4a-patch-value").text("- "+t(this).val()),u()})),t(document).on("change",".left-shoulder-patch input[type=radio]",(function(e){o=t(this).data("amount");const a=parseFloat(t(this).data("amount"))?" + $"+parseFloat(t(this).data("amount")):"";console.log(a),t(".left-shoulder-patch").find(".u4a-patch-value").text("- "+t(this).val()),u()})),t(document).on("change",".right-shoulder-patch input[type=radio]",(function(e){s=t(this).data("amount");const a=parseFloat(t(this).data("amount"))?" + $"+parseFloat(t(this).data("amount")):"";console.log(a),t(".right-shoulder-patch").find(".u4a-patch-value").text("- "+t(this).val()),u()})),t("button.t4s-product-form__submit").on("click",(function(r){if(t("[data-swatch-option]").length!==t("[data-id]").find(".is--selected").length)return void r.preventDefault();if(t(document).find(".variants-options").html(""),t(document).find("#u4aAdditionalPrice").val(""),"Yes"!==t("#add-patches-to-shirt").val()&&!1===l&&!1===h)return;console.log("About to add products");const p=t(this);p.attr("aria-disabled",!0),p.addClass("loading"),p.find(".loading-overlay__spinner").removeClass("hidden"),r.preventDefault(),console.log("Bada bing, bada boom"),c=l?parseFloat("7.99"):h?parseFloat("3.99"):parseFloat(e)+parseFloat(a)+parseFloat(n)+parseFloat(i)+parseFloat(o)+parseFloat(d)+parseFloat(s),c=c.toFixed(2),c>0?t(document).find("#u4aAdditionalPrice").val("$"+c):t(document).find("#u4aAdditionalPrice").val("");const u=t(document).find(".u4a-variants-holder");if(u.length){const e=u.children("fieldset");t.each(e,(function(){const e=t(this).children("legend").children(".variantName").text(),a=t(document).find(`input[name=${e}]:checked`).val();t(document).find(".variants-options").append(`<input type="hidden" name="properties[${e}]" value="${a}" />`)}))}if(!t(".t4s-form__product").validate().form())return console.log("does not validate"),p.attr("aria-disabled",!1),p.removeClass("loading"),void p.find(".loading-overlay__spinner").addClass("hidden");console.log("validates");let f={},m="";m=t(".t4s_ratio.t4s-product__media").find("img").length>0?t("meta[property='og:image:secure_url']").attr("content"):t(".t4s-product__media-item.is--media-last").find("img").prop("currentSrc");const g=new Image;g.src=m;var v=g.width,y=g.height;console.log("Height",y,"Width",v),console.log(m),function(e,a,n){var d=t.Deferred(),i=new Konva.Stage({container:"custom-patches-image-container",width:a,height:n}),o=new Konva.Layer,s=new Image;return s.onload=function(){var e=new Konva.Image({x:0,y:0,image:s,width:a,height:n});o.add(e),i.add(o);var c=i.toDataURL();console.log("dataURL",c),t("body").append(`<img src="${c}" id="img-src-base64" class="hidden" />`),d.resolve()},s.crossOrigin="Anonymous",s.src=e,d.promise()}(m,0===v?550:v,0===y?550:y).done((function(){f.images=[{attachment:t(document).find("#img-src-base64").attr("src").replace(/^data:image\/(png|jpg);base64,/,"")}],f.title=t("meta[property='og:title']").attr("content"),f.sku=t(document).find(".t4s-sku-value").text(),f.parentURL=window.location.href.split("products")[1],f.price=0==c?parseFloat(parseFloat(c)+parseFloat(t(".t4s-product-price").html().split("$")[1])).toFixed(2):parseFloat(t(".t4s-product-price").html().split("$")[1]),console.log(f);const e=function(e){let a="";return t.ajax({type:"POST",url:"https://stark-island-04924.herokuapp.com/api/products?store=686d7b-2",data:e,async:!1,success:function(t){console.log(t),a=t.variants[0].id}}),a}(f);if(console.log(e),void 0===e||!e)return p.attr("aria-disabled",!1),p.removeClass("loading"),p.find(".loading-overlay__spinner").addClass("hidden"),void(alert("Something Went Wrong. Please Try Again")||window.location.reload());let a,n;for(a=t(".t4s-form__product").serializeArray(),n=0;n<a.length;++n)if("id"==a[n].name){a[n].value=e;break}console.log(a),a=jQuery.param(a),console.log(a);let d=!1;if(t.ajax({type:"POST",url:"/cart/add.js",dataType:"json",data:a,async:!1,success:function(t){d=!0}}),!d)return p.attr("aria-disabled",!1),p.removeClass("loading"),p.find(".loading-overlay__spinner").addClass("hidden"),void(alert("Something Went Wrong. Please Try Again")||window.location.reload());window.location.href="/cart"}))})),t(document).on("change",".u4a-variants-holder fieldset input[type=radio]",(function(e){t(this).parents("fieldset").children("legend").find(".selectedVariant").text(t(this).val())}))}));
